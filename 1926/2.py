class Solution:
    def nearestExit(self, maze: list[list[str]], entrance: list[int]) -> int:
        '''
        use the matrix given, make mark (fill each grids the is '.') 
        need condition to recognize if current grid is exit
        for every step, we mark the last gird as 'visited'
        we can use the origin list to mark, since the paths are not interrupting each other
        current_step = prev_step + 1
        try BFS
        works but slow
        '''
        m = len(maze)
        n = len(maze[0])
        res = [[float('inf') for _ in range(n)] for _ in range(m)]
        queue = [(entrance, 0)]
        idx = 0

        def walk(current_idx: list[int], distance: int):
            i, j = current_idx

            if i < 0 or j < 0 or i >= m or j >= n or maze[i][j] != '.':
                return
            count = 0
            for next_i in range(-1, 2):
                for next_j in range(-1, 2):
                    count += 1
                    if count % 2 == 1:
                        '''prevent [-1,1],[0,0]'''
                        continue
                    queue.append(([i+next_i, j+next_j], distance+1))

            maze[i][j] = '!'
            res[i][j] = min(res[i][j], distance)
            return

        while idx < len(queue):
            walk(queue[idx][0], queue[idx][1])
            idx += 1

        print(maze)
        print(res)
        res[entrance[0]][entrance[1]] = float('inf')
        distance = float('inf')
        for i in range(m):
            for j in range(n):
                if (i > 0 and i < m-1) and (j > 0 and j < n-1):
                    continue
                distance = min(res[i][j], distance)
        return distance if distance > 0 and distance != float('inf') else -1


t1 = ([["+", "+", ".", "+"], [".", ".", ".", "+"], ["+", "+", "+", "."]], [1, 2])
t2 = ([[".", "+"]], [0, 0])
t3 = ([["+", "+", "+"], [".", ".", "."], ["+", "+", "+"]], [1, 0])
t4 = ([["+", ".", "+", "+", "+", "+", "+"], ["+", ".", "+", ".", ".", ".", "+"], ["+", ".", "+",
      ".", "+", ".", "+"], ["+", ".", ".", ".", ".", ".", "+"], ["+", "+", "+", "+", ".", "+", "."]], [0, 1])
t5=([[".",".",".",".",".","+",".",".",".","+","+",".","+",".",".",".",".","+",".",".",".",".",".","+",".",".","+",".","+",".",".","+",".",".","+",".",".",".",".",".",".","."],[".",".",".",".",".",".","+","+","+",".","+",".",".","+",".",".",".",".",".",".","+",".","+",".",".",".",".",".",".",".",".",".",".","+","+",".",".","+",".",".","+","."],[".",".",".",".",".",".",".","+","+","+","+","+","+","+",".","+",".",".",".",".","+",".","+","+",".","+",".",".",".",".","+",".",".",".",".","+","+","+","+","+",".","."],["+","+",".","+",".","+",".","+",".",".",".",".",".","+",".","+",".",".",".",".","+",".",".",".",".","+","+",".",".",".",".",".","+",".","+","+","+",".",".",".",".","."],[".","+",".",".",".",".",".",".",".",".","+",".",".",".",".","+",".",".","+",".",".",".",".",".",".",".","+",".",".",".",".",".",".","+",".",".","+",".",".",".","+","+"],["+",".","+","+",".",".","+","+","+",".","+",".","+","+",".","+",".",".","+",".",".",".",".",".",".",".","+",".","+","+",".","+",".","+","+","+",".",".","+",".",".","."],["+",".","+",".",".",".",".",".","+",".",".",".",".",".","+","+",".",".",".","+",".",".",".","+",".",".",".","+","+",".",".",".",".","+","+",".",".",".","+",".",".","+"],[".",".",".",".",".",".",".",".",".",".","+","+","+",".",".",".",".",".",".","+",".","+",".","+","+",".",".",".","+",".",".","+",".","+",".",".",".",".",".",".","+","."],[".",".","+","+",".",".","+",".",".",".",".",".",".","+",".",".","+",".",".",".",".",".",".",".",".",".","+",".","+",".",".","+",".","+",".",".",".","+","+",".",".","."],["+",".",".",".",".","+",".","+",".",".",".",".","+",".",".",".","+","+",".","+","+",".","+",".","+",".","+",".",".","+","+","+",".",".","+",".","+",".",".","+","+","."],[".",".",".",".","+",".","+","+",".",".",".",".","+","+",".",".","+","+",".",".","+",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".",".","+","+","+","."],[".",".",".","+",".",".","+",".",".",".","+","+",".",".","+","+","+","+",".",".",".",".",".","+","+","+",".",".","+",".",".",".",".",".","+",".",".",".",".",".",".","."],[".",".",".",".",".","+",".",".",".",".",".",".",".",".",".",".","+",".","+",".",".",".",".",".","+","+",".",".",".",".",".","+","+","+",".","+","+",".","+",".",".","."],[".","+",".",".","+",".",".","+","+",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".","+",".","+",".",".",".",".",".","+",".",".","+",".","+",".","+"],[".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".","+",".","+",".",".","+","+",".",".","+",".",".",".","+",".",".","+",".",".",".",".",".",".","+","+","."],[".",".","+","+",".",".",".",".",".",".",".",".",".","+","+",".",".",".",".","+","+",".",".",".",".","+","+",".",".",".",".",".","+",".",".",".",".","+",".",".",".","."],[".",".","+",".",".",".","+","+","+",".",".",".",".",".","+",".",".","+",".",".",".","+",".",".","+","+",".",".",".","+",".",".","+",".","+",".",".",".",".","+",".","."],[".",".",".","+",".",".","+",".",".",".",".","+",".",".",".","+",".",".",".",".","+",".",".",".",".",".",".",".",".",".",".","+",".","+",".",".","+","+",".",".","+","."],[".",".",".","+",".",".",".","+","+",".",".",".","+",".","+","+",".","+",".",".","+",".",".",".","+","+","+",".",".",".",".",".",".","+",".",".",".",".",".",".",".","."],["+","+",".","+",".",".",".",".","+",".","+",".",".",".","+",".","+",".",".",".","+","+",".","+",".",".",".","+",".",".","+",".",".","+",".","+",".","+",".","+",".","+"],[".","+","+",".",".",".","+",".","+","+","+",".",".",".",".","+",".",".",".",".","+","+","+",".","+","+",".",".",".",".",".","+",".","+","+","+",".",".","+",".",".","."],[".","+",".","+",".","+",".","+","+",".",".",".",".",".","+","+",".",".",".",".","+",".",".","+",".","+","+","+","+","+","+",".","+","+",".","+",".","+",".",".","+","."],[".",".","+",".","+",".",".",".","+",".",".",".",".",".",".","+","+",".","+","+",".",".",".","+","+",".",".",".","+",".","+",".","+","+",".","+",".",".",".","+",".","."],[".",".",".","+",".",".","+",".","+",".",".",".",".",".",".","+",".","+",".",".",".","+",".","+","+","+",".","+",".",".","+","+",".",".",".",".","+","+","+","+",".","."],[".",".","+",".",".","+","+","+","+","+",".",".",".",".",".",".",".",".",".",".",".","+","+","+",".",".",".","+",".","+",".",".","+",".","+","+",".",".","+",".","+","+"],[".",".",".",".","+",".","+","+","+","+","+",".",".",".","+",".","+",".","+","+",".",".",".","+",".",".",".",".",".","+",".",".",".","+",".",".",".","+","+","+",".","."],[".",".",".","+",".",".",".","+","+",".",".","+",".","+",".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".","+","+",".",".",".","+","+",".",".","+",".","."],[".",".",".",".","+","+","+",".","+",".","+",".",".",".",".","+",".",".",".",".",".","+",".","+",".",".",".",".",".","+",".",".",".",".",".",".",".",".",".",".",".","."],[".",".","+",".",".","+",".",".",".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".","+","+",".","+","+","+",".","+","+",".",".",".","+",".",".","+"],[".","+",".",".","+",".",".",".",".",".",".","+","+",".",".","+",".",".","+",".",".",".","+","+",".","+","+",".",".","+",".",".",".","+",".",".","+","+","+",".","+","+"],[".",".",".","+",".","+",".",".","+",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".",".",".",".",".","+",".","+",".",".",".",".",".","+",".",".","+",".","."],[".",".",".","+",".",".",".",".","+","+","+",".",".","+",".",".","+",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".","+","+","+"],[".",".",".",".","+",".","+","+",".",".",".",".",".",".",".",".",".",".",".","+","+",".","+","+",".","+",".",".","+",".",".","+",".","+",".",".","+","+",".",".",".","."],[".",".",".","+",".",".","+",".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".","+",".","+",".",".",".","+","+",".","+",".",".",".",".",".",".","."],["+",".","+",".",".",".",".",".",".","+",".",".","+",".",".",".",".",".",".",".",".",".","+","+","+",".","+","+",".","+",".",".","+",".",".",".",".","+",".","+","+","."],["+",".",".",".",".",".",".","+",".",".","+",".",".",".",".","+","+","+",".","+","+","+","+",".","+",".",".",".",".",".",".",".",".","+",".","+","+","+",".",".",".","+"],["+",".","+",".","+","+","+",".",".",".","+","+",".",".",".","+","+",".","+",".","+",".",".",".",".","+",".","+",".",".","+",".","+","+",".","+","+",".",".",".","+","."],[".","+",".",".",".",".",".",".","+",".","+",".",".","+",".","+",".","+",".",".","+",".","+",".",".",".",".",".",".",".",".","+","+",".",".",".","+",".",".","+",".","."],["+","+",".",".",".","+","+",".",".","+","+","+",".",".",".",".",".",".",".",".",".","+",".",".","+","+","+",".",".","+",".","+","+",".","+","+",".",".",".",".",".","."],[".",".",".","+","+","+",".",".",".",".",".",".",".",".","+",".","+",".",".","+",".","+","+",".",".",".",".",".",".",".","+",".","+","+",".",".",".","+",".","+",".","+"],["+",".","+","+",".",".",".",".",".","+",".",".",".","+",".",".","+",".","+",".","+",".",".",".",".",".",".",".",".","+",".",".",".",".",".","+",".",".",".",".",".","+"],["+",".","+","+",".",".",".",".",".",".","+","+",".","+","+",".",".",".",".","+",".",".",".","+",".",".",".","+",".","+",".",".",".",".",".",".",".",".","+","+",".","+"],[".","+",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".","+",".","+",".",".",".",".",".",".",".",".",".",".",".","+","+",".",".","+",".","+",".","+"],["+","+",".",".",".",".","+",".","+",".",".",".",".",".","+","+",".","+","+",".",".",".","+",".",".","+",".",".","+","+",".",".",".",".","+","+",".",".",".",".",".","."],["+",".",".",".","+",".","+","+","+",".",".","+",".",".",".",".",".",".",".","+","+","+",".",".",".",".",".",".",".","+","+",".",".",".",".",".","+","+",".",".",".","."],[".",".",".","+",".",".",".",".","+",".","+",".","+","+",".",".",".","+",".",".",".",".",".",".",".",".","+",".",".","+","+",".",".",".","+","+",".","+","+",".",".","+"],[".","+","+",".",".","+",".","+",".","+",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".","+",".",".","+",".",".",".",".","+",".",".","+","+",".",".",".","."],["+",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".","+",".","+",".",".",".",".",".",".",".",".",".",".","+",".","+",".",".",".","+",".",".",".",".",".","."],[".",".",".",".","+",".",".","+",".","+",".",".","+","+","+",".",".","+",".",".",".",".","+",".","+","+",".",".","+",".",".","+",".",".","+",".","+","+",".",".",".","."]],[48,41])
# r = Solution().nearestExit(t1[0], t1[1])
# r = Solution().nearestExit(t2[0], t2[1])
# r = Solution().nearestExit(t3[0], t3[1])
# r = Solution().nearestExit(t4[0], t4[1])
r = Solution().nearestExit(t5[0], t5[1])
print(r)
